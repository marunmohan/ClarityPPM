--Returns the planned and actual cost by project task

SELECT
  INV.NAME "Investment",
  TASK.PRNAME "Task",
  SUM(WV.TOTALCOST) "Total Cost",
  SUM(WV.ACTUALCOST) "Actual Cost"
FROM INV_INVESTMENTS INV
  INNER JOIN  PRTASK TASK
    ON        TASK.PRPROJECTID = INV.ID
  INNER JOIN  PPA_WIP WIP
    ON        TASK.PRID = WIP.TASK_ID
  INNER JOIN  PPA_WIP_VALUES WV
    ON        WIP.TRANSNO = WV.TRANSNO
WHERE INV.CODE = 'PR1002' --Type the code of any project
  AND WV.CURRENCY_TYPE = 'HOME'
  AND TASK.PRWBSLEVEL = 2
GROUP BY INV.NAME,
         TASK.PRNAME,
         TASK.PRWBSSEQUENCE
ORDER BY TASK.PRWBSSEQUENCE
